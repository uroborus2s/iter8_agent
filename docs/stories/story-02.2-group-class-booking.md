# 用户故事 02.2: 团课快速预约

## 故事信息
- **故事ID**: 02.2
- **故事标题**: 团课快速预约
- **所属史诗**: 史诗02 - 核心预约体验
- **优先级**: 高
- **负责团队**: 前端开发团队 + 后端开发团队

## 故事描述

**作为** 一名想要参加团体课程的用户
**我想要** 快速找到并加入一个4人制的团课
**这样我可以** 以更经济的价格享受网球乐趣，并认识新球友

## 价值说明

### 核心价值
团课是吸引价格敏感用户和初学者、增强社区活性的重要产品。提供流畅的团课预约体验，特别是"还差N人"的实时状态展示，能有效利用用户的"凑团"心理，加速课程成团，提升课程的成功率和场地的坪效。

### 业务价值
- **扩大用户群体**: 较低的价格门槛能吸引更多初级和学生用户。
- **提高场地坪效**: 在单位时间内，一个场地可以服务更多用户，创造更高价值。
- **增强社区粘性**: 团课是用户之间建立社交联系的天然场景。
- **提高课程成功率**: 透明的参团进度能激励用户主动分享和邀请，加速成团。

## 详细需求

### 功能需求
1.  **团课列表**:
    *   在课程列表中，清晰标识出"团课"类型。
    *   每个团课卡片上实时显示"已报名X/4人"、"还差Y人成团"等状态。
    *   当"仅剩1个名额"或"即将满员"时，用特殊标签或颜色突出显示，营造紧迫感。
2.  **团课详情**:
    *   展示课程的详细信息：教练、时间、场地、难度等级、课程目标（如"底线基础训练"）。
    -   匿名化展示已报名用户的头像和昵称（如"用户A"、"用户B"），保护隐私但展示热度。
3.  **预约流程**:
    *   用户选择团课后，点击"立即报名"。
    *   进入确认页面，显示课程信息和价格。
    -   用户完成支付，即视为报名成功。
4.  **成团与开课**:
    *   当报名人数达到4人时，系统自动将课程状态标记为"已成团"。
    *   系统向所有已报名用户发送"组团成功"的通知。
5.  **不成团处理**:
    *   如果到了课程开始前一定时间（如提前2小时）仍未凑够4人，系统自动取消该课程。
    *   系统向已报名用户发送"组团失败"的通知，并自动处理全额退款。

### 非功能需求
-   **性能**: 团课报名人数状态需实时或准实时更新，延迟<1分钟。
-   **数据一致性**: 严格保证报名人数的准确性，防止超卖。
-   **可用性**: 报名状态和流程的提示清晰易懂。

## 验收标准

### 功能验收标准
-   **AC1**: 用户可以在列表中看到团课的实时报名人数。
-   **AC2**: 用户可以成功报名并支付一个未满员的团课。
-   **AC3**: 报名人数达到4人后，该课程状态变为"已成团"，无法再报名。
-   **AC4**: 在规定时间未成团的课程，系统能自动取消并退款。
-   **AC5**: 所有状态变更（报名成功、成团、取消）用户都能收到相应的通知。

### 用户体验验收标准
-   **UX1**: "还差X人"的状态清晰可见，能有效吸引用户点击。
-   **UX2**: 报名流程简单快捷，不超过3步。
-   **UX3**: 组团失败的退款流程自动化，用户体验无感、顺畅。

### 业务目标验收标准
-   **BIZ1**: 团课成团率达到70%以上。
-   **BIZ2**: 团课预约占总预约量的30%以上。

## 依赖关系

### 技术依赖
-   场地信息实时展示功能 (Story 02.1)
-   支付与交易功能 (Epic 03)
-   消息通知系统
-   定时任务系统（用于处理不成团的课程）

### 业务依赖
-   已定义好团课的产品模式、价格和不成团的规则。
-   已有教练资源可提供团课。

### 外部依赖
-   支付网关
-   消息推送服务

## 风险与缓解措施

### 主要风险
1.  **并发报名风险**: 仅剩一个名额时，多个用户同时报名。
    -   **缓解措施**: 使用数据库事务和悲观锁或乐观锁机制，确保只有一个用户能成功。
2.  **用户体验落差**: 用户报名后，课程最终因未成团而取消。
    -   **缓解措施**:
        *   在报名时清晰告知有不成团的风险。
        *   提供临近成团的课程推荐，引导用户。
        *   不成团的退款和通知要做到极致的及时和顺畅，将负面体验降到最低。

## 成功指标

### 定量指标
-   **团课成团率**: >70%
-   **平均成团耗时**: <课程开始前6小时
-   **团课预约转化率**: >50% (从浏览详情到报名成功)

### 定性指标
-   **用户满意度**: 用户对团课模式的满意度>4.2/5
-   **社交价值**: 用户因团课结识新球友的反馈增多

## 变更日志

| 日期 | 版本 | 描述 |
| :--- | :--- | :---------- |
|      | 1.0  | 初始版本创建，定义团课快速预约功能 |

## 相关故事

### 依赖故事
- US-01.1: 微信一键注册（用户身份基础）
- US-02.1: 场地信息实时展示（数据基础）

### 后续故事
- US-03.1: 微信支付集成（支付流程）
- US-04.1: 分享约课功能（社交扩展）

## 设计要点

### 界面设计
- 团课卡片设计：关键信息一目了然
- 预约按钮突出：明确的行动召唤
- 进度指示：让用户清楚当前步骤

### 交互设计
- 一键预约：减少操作步骤
- 实时反馈：每个操作都有即时响应
- 错误处理：友好的错误提示和恢复建议

## 备注

- 这是实现"3分钟预约"核心价值的关键故事
- 需要密切监控预约转化率和用户满意度
- 建议进行用户测试，不断优化预约流程

## 变更日志

| 日期 | 版本 | 描述 | 作者 |
| :--- | :------ | :---------- | :----- |
| 2024-12-27 | 1.0 | 初始版本创建 | 姜尚 | 