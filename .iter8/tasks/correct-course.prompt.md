# 航向修正任务 (Correct Course Task)

## 目的 (Purpose)

- 使用 `变更检查清单 (change-checklist)` 来引导对变更触发事件的结构化响应。
- 在检查清单的指导下，分析变更对史诗（Epics）、项目产物和最小可行产品（MVP）的影响。
- 按照检查清单的提示，探索潜在的解决方案（例如，调整范围、回滚元素、重新定义功能范围）。
- 基于分析，为所有受影响的项目产物（如史诗、用户故事、PRD章节、架构文档部分）起草具体、可操作的更新建议。
- 生成一份整合的 **“冲刺变更建议书 (Sprint Change Proposal)”** 文档，其中包含影响分析和清晰起草的编辑建议，供用户审查和批准。
- 如果变更的性质需要其他核心代理（如产品经理或架构师）进行根本性的重新规划，确保有明确的交接路径。

## 操作指南 (Instructions)

### 1. 初始设置与模式选择 (Initial Setup & Mode Selection)

- **确认任务与输入：**
  - 向用户确认已启动“航向修正任务”（变更导航与整合）。
  - 核实变更触发原因，并确保已获取用户对问题的初步解释及其感知到的影响。
  - 确认可以访问所有相关的项目产物（如 PRD、史诗/故事、架构文档、UI/UX规范），以及至关重要的 `变更检查清单 (change-checklist)`。
- **建立交互模式：**
  - 询问用户在此任务中偏好的交互模式：
    - **“增量模式 (Incremental Mode)（默认 & 推荐）：** 我们是否逐节地过一遍 `变更检查清单`，在进入下一部分之前，讨论每个相关部分的发现并协同起草变更建议？这有助于进行详细、逐步的完善。”
    - **“批处理模式 (YOLO Mode)（批量处理）：** 或者，您是否希望我基于检查清单进行更批量的分析，然后提交一份整合的发现和变更建议以供更全面的审查？这对于初步评估可能更快，但可能需要对合并后的提案进行更广泛的审查。”
  - 请求用户选择他们偏好的模式。
  - 用户选择后，确认所选模式（例如，“好的，我们将以增量模式进行。”）。所选模式将决定此任务后续步骤的执行方式。
- **解释流程：** 简要告知用户：“我们现在将使用 `变更检查清单` 来分析变更并起草更新建议。我将根据我们选择的交互模式引导您过一遍检查清单项目。”
  <rule>当一次性提出多个问题或多个需要用户输入的点时，请清晰地编号（例如，1., 2a., 2b.），以便用户更容易地提供具体的回应。</rule>

### 2. 执行检查清单分析 (Execute Checklist Analysis)（根据交互模式，迭代或批量进行）

- 系统性地完成 `变更检查清单` 的第 1-4 部分（通常涵盖变更背景、史诗/故事影响分析、产物冲突解决和路径评估/建议）。
- 对于每个检查清单项目或逻辑分组（取决于交互模式）：
  - 向用户展示检查清单中的相关提示或考量因素。
  - 请求必要信息，并主动分析相关项目产物（PRD、史诗、架构文档、故事历史等）以评估影响。
  - 与用户讨论您对每个项目的发现。
  - 记录每个检查清单项目的状态（例如，`[x] 已处理`, `[N/A]`, `[!] 需要进一步行动`）以及任何相关的笔记或决策。
  - 按照检查清单第 4 部分的提示，协同商定“推荐的前进路径”。

### 3. 起草变更建议 (Draft Proposed Changes)（迭代或批量进行）

- 基于完成的检查清单分析（第 1-4 部分）和商定的“推荐的前进路径”（不包括需要立即移交给产品经理/架构师进行根本性重新规划的场景）：
  - 识别需要更新的具体项目产物（例如，特定的史诗、用户故事、PRD章节、架构文档组件、图表）。
  - **为每个已识别的产物直接且明确地起草变更建议。** 示例包括：
    - 修订用户故事文本、验收标准或优先级。
    - 在史诗中添加、删除、重新排序或拆分用户故事。
    - 提议修改架构图的片段（例如，提供更新后的 Mermaid 图表块或对现有图表的清晰文字描述）。
    - 更新技术清单、配置细节或 PRD/架构文档中的特定部分。
    - 如有必要，起草新的小型支持性产物（例如，针对特定决策的简要附录）。
  - 如果处于“增量模式”，在起草每个产物或相关产物小组的编辑建议时，与用户讨论并完善。
  - 如果处于“批处理模式”，则编译所有已起草的编辑建议，以便在下一步中展示。

### 4. 生成包含编辑建议的“冲刺变更建议书” (Generate "Sprint Change Proposal" with Edits)

- 将完整的 `变更检查清单` 分析（涵盖第 1-4 部分的发现）和所有商定的变更建议（来自第 3 步）合成为一份名为“冲刺变更建议书”的单一文档。此建议书应与 `变更检查清单` 第 5 部分（提案组件）建议的结构保持一致。
- 建议书必须清晰地呈现：
  - **分析摘要：** 对原始问题、其分析后的影响（对史诗、产物、MVP范围）以及所选路径的基本原理的简明概述。
  - **具体变更建议：** 对于每个受影响的产物，清晰地展示或描述确切的变更（例如，“将故事 X.Y 从：[旧文本] 更改为：[新文本]”，“向故事 A.B 添加新的验收标准：[新AC]”，“按如下方式更新架构文档第 3.2 节：[新的/修改后的文本或图表描述]”）。
- 将完整的“冲刺变更建议书”草案呈现给用户进行最终审查和反馈。根据用户的要求，纳入任何最终调整。

### 5. 最终确定并决定后续步骤 (Finalize & Determine Next Steps)

- 获得用户对“冲刺变更建议书”及其包含的所有具体编辑的明确批准。
- 向用户提供最终定稿的“冲刺变更建议书”文档。
- **基于已批准变更的性质：**
  - **如果已批准的编辑足以解决变更，并且可以直接实施或由 PO/SM 组织：** 声明关于分析和变更建议的“航向修正任务”已完成，用户现在可以着手实施或记录这些变更（例如，更新实际的项目文档、待办事项）。如果合适，建议移交给 PO/SM 代理进行待办事项的组织。
  - **如果分析和建议的路径（根据检查清单第 4 部分和可能的第 6 部分）表明变更需要更根本性的重新规划（例如，重大的范围变更、主要的架构重构）：** 清晰地陈述此结论。建议用户下一步应让主要的产品经理或架构师代理参与进来，并将“冲刺变更建议书”作为该深度重新规划工作的关键输入和背景。

## 输出交付物 (Output Deliverables)

- **主要交付物：** 一份“冲刺变更建议书”文档（Markdown 格式）。该文档将包含：
  - `变更检查清单` 的分析摘要（问题、影响、所选路径的理由）。
  - 针对所有受影响项目产物的具体、清晰起草的编辑建议。
- **隐式交付物：** 一份带注释的 `变更检查清单`（或其完成记录），反映了在此过程中进行的讨论、发现和决策。
