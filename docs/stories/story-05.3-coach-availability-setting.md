# 用户故事 05.3: 教练可用时间设置

## 故事信息
- **故事ID**: 05.3
- **故事标题**: 教练可用时间设置
- **所属史诗**: 史诗05 - 教练管理
- **优先级**: 高
- **负责团队**: 教练端团队 + 后端开发团队

## 故事描述

**作为** 一名平台签约教练
**我想要** 能够灵活、方便地在我的日程表上设置我每周的"可预约时间段"
**这样我可以** 向平台上的学员准确地展示我的空闲时间，从而获得符合我日程安排的预约订单

## 价值说明

### 核心价值
教练的"可预约时间"是平台可售卖商品(服务)的库存。提供一个强大而易用的库存管理工具，让教练能轻松地发布和管理他们的时间，是整个预约平台能够运转起来的最基础、最核心的一环。这直接决定了平台上"货架"的丰富程度。

### 业务价值
- **增加平台供给**: 易用的工具能鼓励教练开放更多的可预约时间，直接增加平台的服务供给量。
- **提升数据准确性**: 保证了用户端所见可约时间的准确性，这是所有后续预约流程的基础。
- **增强教练自主性**: 让教练能完全掌控自己的工作时间，符合他们作为"独立合作者"的身份，提升满意度和归属感。
- **支持灵活运营**: 可以支持不同教练设置不同的可约时间模式(如全职教练、周末兼职教练)。

## 详细需求

### 功能需求

#### 1. 设置常规可约时间 (Recurring Availability)
- **入口**: 在教练日程或设置中，提供"设置常规空闲时间"的入口。
- **设置界面**:
    - 提供一个以"周"为单位的视图(周一到周日)。
    - 教练可以通过类似在日历上涂抹的方式，选择每周中固定的可预约时间段。
    - 例如，教练可以选择"每周三、周五的下午2点到5点"以及"每周六全天"为常规可约时间。
- **应用与生效**:
    - 保存后，系统会自动将此规则应用到未来的日程中(如未来2-4周)，批量生成大量的"可预约"时间槽(Time Slot)。

#### 2. 设置特殊可约/不可约时间 (Specific Availability)
- **场景**: 用于处理临时性的日程安排。
- **设置方式**:
    - **增加可约时间**: 教练可以直接在某一天(如"下周一上午")的空白处，点击并设置为"可预约"。
    - **屏蔽可约时间**: 教练可以点击一个已经设为"可预约"的时间段，并将其临时屏蔽(如"我这周六下午临时有事，关闭预约")，变为"不可预约"。此操作不应影响常规设置。
- **冲突处理**: 如果某个时间段已有课程安排，则该时间段不能被设置为"不可预约"。

#### 3. 时间模板功能 (可选)
- **场景**: 方便教练在不同模式间切换。
- **功能**:
    - 教练可以将一套常规时间设置保存为"模板"，如"夏季作息"、"冬季作息"。
    - 可以一键应用某个模板到自己的日程上。

### 非功能需求
- **性能**: 设置常规时间并应用到未来日程的后台处理，应在数秒内完成。日程视图的加载和刷新要快。
- **可用性**:
    - 时间选择的交互要非常直观、流畅，特别是在手机小屏幕上。
    - 常规设置和特殊设置的逻辑要清晰，用户不会混淆。
- **数据一致性**: 后台生成的时间槽必须准确无误。对已有预约的时间段，必须进行锁定，防止被错误操作覆盖。

## 验收标准

### 功能验收标准
- **AC1**: 教练可以成功设置"每周三下午"为常规可约时间，并能在未来几周的日程中看到对应的可约时间段。
- **AC2**: 教练可以成功地将"下周一上午"这个特定的时间段，临时设置为可预约。
- **AC3**: 教练可以成功地将一个常规的"可预约"时间段临时屏蔽掉，用户端会同步显示为不可约。
- **AC4**: 所有已存在预约的时间段，都不能被教练的操作(如屏蔽)所影响。

### 用户体验验收标准
- **UX1**: 在周视图上选择时间段的操作，如同用荧光笔在书上划线一样流畅自然。
- **UX2**: 教练能清晰地理解"常规设置"和"临时调整"的区别和效果。
- **UX3**: 所有操作都有即时的视觉反馈。

### 业务目标验收标准
- **BIZ1**: 平台上所有活跃教练都设置了他们的可预约时间。
- **BIZ2**: 平台上可供用户预约的总时长(供给量)每周持续增长。
- **BIZ3**: 因教练时间设置错误导致的预约失败事故为零。

## 依赖关系

### 技术依赖
-   教练日程管理 (Story 05.1) 的日历视图
-   后端数据库需要有高效的表结构来存储教练的可用时间规则和生成的具体时间槽
-   定时任务系统(用于定期根据规则生成未来的可约时间)

### 业务依赖
-   平台已定义好课程的基础时长单位(如1小时、1.5小时、2小时)。

### 外部依赖
-   无

## 风险与缓解措施

### 主要风险
1.  **交互复杂性**: 在手机小屏幕上设计一个既强大又易用的周循环时间选择器，具有挑战性。
    -   **缓解措施**:
        *   进行充分的UI/UX设计和原型测试。
        *   参考业界成熟的日历和日程管理应用的设计(如Google Calendar, Calendly)。
        *   提供Web端作为手机端操作不便的补充。
2.  **数据量大**: 如果为每个教练将未来一年的时间槽都生成出来，数据量会非常庞大，影响性能。
    -   **缓解措施**:
        *   采用"动态生成"与"预生成"结合的策略。只预先生成未来2-4周的具体时间槽数据。更远的时间，在用户查询时根据规则动态计算。
        *   对数据库表进行索引和分区优化。

## 成功指标

### 定量指标
-   **教练设置率**: 100%的活跃教练完成设置
-   **可预约时间槽数量**: 持续增长
-   **页面操作耗时**: 完成一次常规时间设置 < 2分钟

### 定性指标
-   **教练反馈**: 教练认为该功能"灵活"、"强大"、"省事"。

## 变更日志

| 日期 | 版本 | 描述 |
| :--- | :--- | :---------- |
|      | 1.0  | 初始版本创建，定义教练可用时间设置功能 | 