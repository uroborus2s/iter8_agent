# 用户故事 05.2: 教练预约请求管理

## 故事信息
- **故事ID**: 05.2
- **故事标题**: 教练预约请求管理
- **所属史诗**: 史诗05 - 教练管理
- **优先级**: 高
- **负责团队**: 教练端团队 + 后端开发团队

## 故事描述

**作为** 一名平台签约教练
**我想要** 能够在一个集中的列表里，快速查看和处理所有学员向我发出的预约请求
**这样我可以** 及时响应学员，提高我的订单确认率，并给学员留下专业高效的好印象

## 价值说明

### 核心价值
学员的预约请求是教练商业机会的直接体现。为教练提供一个清晰、高效的请求管理界面，并配合及时的通知，是保障这些商业机会被快速捕获、不流失的关键。这直接关系到教练的收入和学员的满意度。

### 业务价值
- **提高订单转化率**: 及时响应能显著提高预约的最终确认率和支付率。
- **提升用户体验**: 快速的确认反馈能极大提升学员侧的用户体验，减少等待的焦虑。
- **优化教练口碑**: "秒回"的教练显然比"几小时后才回复"的教练更受欢迎，有助于教练建立专业、可靠的个人品牌。
- **增强平台活跃度**: 教练的及时响应，是平台交易流程能顺畅运转的核心润滑剂。

## 详细需求

### 功能需求

#### 1. 预约请求通知
- **实时推送**: 当有新的学员预约请求时，系统需通过App Push和/或短信，立即通知教练。
- **通知内容**: 通知中应包含核心信息，如"学员XXX想预约您周六下午2点的私教课，请及时处理"。

#### 2. 预约请求列表
- **统一入口**: 在教练端工作台，提供一个"预约请求"或"订单管理"的统一入口，并用角标显示未处理的请求数量。
- **列表展示**:
    - 按请求时间倒序排列所有预约请求。
    - 每个请求以卡片形式展示，包含：学员昵称、头像、请求的课程时间、课程类型、场地、拟支付金额。
    - 清晰地标示出每个请求的状态，如"待处理"、"已接受"、"已拒绝"、"已超时"。
- **筛选功能**: 支持按状态筛选请求。

#### 3. 请求处理功能
- **处理界面**: 点击一个"待处理"的请求，进入处理界面。
- **冲突检测与提示**:
    - 在处理界面，系统应再次检测该时间段是否与教练已有的其他日程冲突。
    - 如果有冲突，系统应给出明显提示，但仍允许教练自行决策（也许教练可以协调）。
- **"接受"操作**:
    - 点击"接受"按钮。
    - 系统将该预约的状态变更为"待支付"，并立即通知学员去付款。
- **"拒绝"操作**:
    - 点击"拒绝"按钮。
    - 系统会弹出一个窗口，让教练选择或填写拒绝原因（如"时间冲突"、"不适合该学员"等）。
    - 系统将该预约的状态变更为"已拒绝"，并通知学员，告知其被拒绝的原因。

#### 4. 超时自动处理
- **超时机制**: 如果教练在规定时间（如2小时）内未处理某个请求。
- **自动取消**: 系统将自动拒绝该预约，状态标记为"超时未处理"。
- **通知用户**: 系统会自动通知学员"教练暂时无法接单，请尝试预约其他教练"，并可以附上其他教练的推荐。

### 非功能需求
- **实时性**: 通知推送的延迟应<30秒。列表状态的更新应是实时的。
- **可靠性**: 通知系统必须高度可靠，保证教练不会错过任何预约请求。
- **可用性**: 请求处理的操作流程应极致简化，最好能一键完成。

## 验收标准

### 功能验收标准
- **AC1**: 新的预约请求能通过App Push实时通知到教练。
- **AC2**: 教练可以在请求列表中看到所有待处理的预约，并可进行接受或拒绝操作。
- **AC3**: 教练接受请求后，学员会收到支付通知。
- **AC4**: 教练拒绝请求后，学员会收到被拒通知及原因。
- **AC5**: 对于超过2小时未处理的请求，系统会自动拒绝，并通知学员。

### 用户体验验收标准
- **UX1**: 通知及时、清晰，包含了做决策所需的关键信息。
- **UX2**: 列表和处理界面的信息布局合理，状态一目了然。
- **UX3**: "接受"和"拒绝"操作快捷、流畅。

### 业务目标验收标准
- **BIZ1**: 教练的平均请求处理时间 < 30分钟。
- **BIZ2**: 因教练未及时处理而导致的订单流失率 < 5%。
- **BIZ3**: 平台的整体预约确认率 > 90%。

## 依赖关系

### 技术依赖
-   教练日程管理 (Story 05.1)
-   后端预约和订单系统，支持状态流转
-   消息通知系统（App Push, SMS）
-   定时任务系统（用于处理超时请求）

### 业务依赖
-   已定义好教练处理请求的SLA（如必须2小时内响应）。
-   已准备好各种拒绝原因的模板文案和超时未处理的对客文案。

### 外部依赖
-   消息推送服务提供商（如APNs, FCM）
-   短信服务提供商

## 风险与缓解措施

### 主要风险
1.  **通知不可达**: 因用户关闭通知权限、网络问题等，导致教练未收到通知。
    -   **缓解措施**:
        *   采用多通道通知策略（如App Push + 短信）。
        *   在教练端App的图标上用角标(Badge)显示未处理数量，作为提醒。
        *   引导和激励教练开启通知权限。
2.  **教练恶意行为**: 教练看到不满意的订单（如价格低）就故意不处理，拖到超时。
    -   **缓解措施**:
        *   将"请求响应率"和"平均响应时长"作为教练服务质量的关键指标。
        *   这些指标与教练的搜索排名、平台推荐、佣金费率等利益挂钩，引导教练及时响应所有请求。

## 成功指标

### 定量指标
-   **平均请求处理时长**: < 30分钟
-   **请求响应率**: > 98%
-   **通知到达率**: > 99%

### 定性指标
-   **教练反馈**: 教练认为此功能让他们处理订单变得"非常轻松和高效"。
-   **学员反馈**: 学员感觉平台的预约反馈"非常快"。

## 变更日志

| 日期 | 版本 | 描述 |
| :--- | :--- | :---------- |
|      | 1.0  | 初始版本创建，定义教练预约请求管理功能 | 